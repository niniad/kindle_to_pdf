# Kindle to PDF Desktop App

Kindle for PC の画面をキャプチャし、PDFに変換するデスクトップアプリケーションです。

## 特徴
- **GUI操作**: 直感的なインターフェースで操作可能。
- **自動キャプチャ**: ページめくりとスクリーンショット撮影を自動化。
- **PDF生成**: 撮影した画像をPDFに結合して保存。
- **NotebookLM最適化**: 生成されるPDFはNotebookLMへのアップロードに適した形式です。

## 実行方法

### 推奨: バッチファイルから起動
プロジェクトルートにある `run_app.bat` をダブルクリックして実行してください。
- 初回起動時に自動的に仮想環境(`.venv`)を作成し、必要なライブラリをインストールします。

### 手動実行 (コマンドライン)
Python環境が整っている場合は、以下のコマンドでも実行可能です。

```bash
# 仮想環境の作成と有効化 (任意)
python -m venv .venv
.venv\Scripts\activate

# ライブラリのインストール
pip install -r src/requirements.txt

# アプリケーションの起動
python src/app.py
```

## 操作手順
1. **設定**: 
   - 本のタイトルを入力します。
   - ページめくり方向（左キー/右キー）を選択します。
   - キャプチャ範囲を選択します（「範囲を選択」ボタンをクリックし、Kindleのウィンドウ範囲をドラッグして指定）。
2. **キャプチャ開始**:
   - 「自動キャプチャ開始」ボタンをクリックします。
   - 5秒間のカウントダウン中にKindleウィンドウをアクティブにします。
   - キャプチャが自動的に進行します。重複ページ（最終ページ）を検知すると自動停止します。
3. **PDF生成**:
   - 「PDF生成」ボタンをクリックすると、`output_pdfs` フォルダにPDFが出力されます。

## ディレクトリ構成
- `src/`: ソースコード
- `captured_images/`: キャプチャされた画像の一時保存先
- `output_pdfs/`: 生成されたPDFの保存先
- `run_app.bat`: アプリ起動用スクリプト
